
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>Shelter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Donald Wu">
    

    
    <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Shelter">
<meta property="og:url" content="http://wuyihao14.github.io/page/5/index.html">
<meta property="og:site_name" content="Shelter">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shelter">
<meta name="twitter:description">

    
    <link rel="alternative" href="/atom.xml" title="Shelter" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Shelter" title="Shelter"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Shelter">Shelter</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜單">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:wuyihao14.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/11/02/OsaisenChoudai/" title="Osaisen Choudai" itemprop="url">Osaisen Choudai</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Donald Wu" target="_blank" itemprop="author">Donald Wu</a>
		
  <p class="article-time">
    <time datetime="2015-11-02T10:42:59.327Z" itemprop="datePublished"> 發表於 2015-11-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Osaisen Choudai!<br>Time Limit: 3000MS        Memory Limit: 65536KB        64bit IO Format: %lld &amp; %llu<br>Submit</p>
<p>Status</p>
<p>Description<br>A saisenbako (賽銭箱, offertory, or religious collection box) is situated in front of the hall of Hakurei Shrine. Hakurei Reimu (博麗霊夢), the miko of Hakurei Shrine, may ask the friends who are visting her to throw some saisen (賽銭, offerings, or coins) into it. Reimu wants as much saisen as possible. Howerver, she cannot ask for saisen too frequently, because this will make her friends refuse to offer any more. On the other hand, if she doesn’t ask for saisen for a very long period, her friends will become not be willing to offer any more. Generally, at the i-th day, if she asks for saisen, then she will get sisaisen, what’s more, she cannot ask again for xi days (including the i-th day), and she should ask again in yi days (including the i-th day).</p>
<p>Given si, xi and yi for n days, how much saisen can Reimu get at most in these days if she asks saisen at the first day?</p>
<p>Input<br>The are multiple cases. Each case begins with a line of integer 0 &lt; n &lt; 50000, then n lines, each contains 3 positive integers: si, and xi &lt; yi. Process to the end of file.</p>
<p>Output<br>For each test cases, output an integer, the maximun amount of saisen Reimu can get, in a seperate line. It’s guaranteed that the answer always fit into a 32-bit signed integer.</p>
<p>Sample Input<br>3<br>1 1 2<br>2 2 3<br>3 3 4<br>3<br>1 1 3<br>2 2 4<br>3 3 5<br>4<br>10 3 10<br>7 1 7<br>5 2 5<br>1 1 2<br>5<br>1 1 9<br>10 3 10<br>7 1 7<br>5 2 5<br>1 1 2<br>Sample Output<br>3<br>4<br>11<br>13</p>
<p>线段树优化dp，可是二维暴力居然过了。</p>
<pre><code>include &lt;cstdio&gt;

<span class="keyword">int</span> f[<span class="number">50010</span>];
<span class="keyword">int</span> s[<span class="number">50010</span>];
<span class="keyword">int</span> x[<span class="number">50010</span>];
<span class="keyword">int</span> y[<span class="number">50010</span>];

<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{
    <span class="keyword">return</span> a &gt; b?a : b;
}

<span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{
    <span class="keyword">return</span> a &lt; b?a : b;
}

<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{
    <span class="keyword">int</span> n;
    <span class="comment">//freopen("fuck","w",stdout);</span>
    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)){
        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)
            <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,s+i,x+i,y+i);

        <span class="keyword">for</span> (<span class="keyword">int</span> i=n-<span class="number">1</span>;i&gt;-<span class="number">1</span>;i--)
        {
            <span class="keyword">int</span> lo = max(i+<span class="number">1</span>,i+x[i]);
            f[i] = s[i];
            <span class="keyword">for</span> (<span class="keyword">int</span> j=min(n-<span class="number">1</span>,i+y[i]-<span class="number">1</span>);j&gt;=lo;j--){
                f[i] = max(f[i],f[j]+s[i]);
            }
        }

        <span class="comment">/*
           int ans = 0;
           for (int i=0;i&lt;n;i++)
           ans = max(ans,f[i]);
         */</span>
        <span class="keyword">int</span> ans = f[<span class="number">0</span>];
        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);
    }

    <span class="keyword">return</span> <span class="number">0</span>;
}
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/ACM/">ACM</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/11/02/CityHorizon_矩形切割/" title="City Horizon" itemprop="url">City Horizon</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Donald Wu" target="_blank" itemprop="author">Donald Wu</a>
		
  <p class="article-time">
    <time datetime="2015-11-02T10:42:59.327Z" itemprop="datePublished"> 發表於 2015-11-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Description<br>Farmer John has taken his cows on a trip to the city! As the sun sets, the cows gaze at the city horizon and observe the beautiful silhouettes formed by the rectangular buildings.</p>
<p>The entire horizon is represented by a number line with N (1 ≤ N ≤ 40,000) buildings. Building i’s silhouette has a base that spans locations Ai through Bi along the horizon (1 ≤ Ai &lt; Bi ≤ 1,000,000,000) and has height Hi (1 ≤ Hi ≤ 1,000,000,000). Determine the area, in square units, of the aggregate silhouette formed by all N buildings.</p>
<p>Input<br>Line 1: A single integer: N<br>Lines 2.. N+1: Input line i+1 describes building i with three space-separated integers: Ai, Bi, and Hi<br>Output<br>Line 1: The total area, in square units, of the silhouettes formed by all N buildings<br>Sample Input<br>4<br>2 5 1<br>9 10 4<br>6 8 2<br>4 6 3<br>Sample Output<br>16<br>Hint<br>The first building overlaps with the fourth building for an area of 1 square unit, so the total area is just 3<em>1 + 1</em>4 + 2<em>2 + 2</em>3 - 1 = 16.<br>Source<br>USACO 2007 Open Silver</p>
<hr>
<p>矩形切割模板题，代码太容易理解了，就是当前枚举到：前k个矩形划分出来的某一个小块，如果不被后面的矩形切割了，便加入答案，否则继续切割。</p>
<pre><code><span class="preprocessor">#<span class="keyword">include</span> &lt;stdio.h&gt;  </span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;string.h&gt;  </span>
<span class="preprocessor">#<span class="keyword">include</span> &lt;algorithm&gt;  </span>

<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;  

<span class="preprocessor">#<span class="keyword">define</span> ll long long </span>

<span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40010</span>;  

<span class="keyword">struct</span> Build
{  
    ll x1,y1;  
    ll x2,y2;  
    ll sum;  

    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Build&amp; b2)<span class="keyword">const</span> {
        <span class="keyword">if</span> (y2 != b2.y2)
            <span class="keyword">return</span> y2&lt;b2.y2;
        <span class="keyword">if</span> (x2 != b2.x2)
            <span class="keyword">return</span> x2&lt;b2.x2;
        <span class="keyword">return</span> x1&gt;b2.x1;
    }
};
Build building[N];

ll n;  

<span class="function"><span class="keyword">void</span> <span class="title">Cover</span><span class="params">(ll x1,ll y1,ll x2,ll y2,ll k,ll c)</span></span>{  
    <span class="keyword">while</span>(k&lt;n&amp;&amp;(x1&gt;=building[k].x2||x2&lt;=building[k].x1||y1&gt;=building[k].y2||y2&lt;=building[k].y1)) k++;
    <span class="keyword">if</span>(k&gt;=n){  
        building[c].sum+=(x2-x1)*(y2-y1);  
        <span class="keyword">return</span>;  
    }  
    <span class="keyword">if</span>(x1&lt;building[k].x1){  
        Cover(x1,y1,building[k].x1,y2,k+<span class="number">1</span>,c);  
        x1=building[k].x1;  
    }  
    <span class="keyword">if</span>(x2&gt;building[k].x2){  
        Cover(building[k].x2,y1,x2,y2,k+<span class="number">1</span>,c);  
        x2=building[k].x2;  
    }  
    <span class="keyword">if</span>(y1&lt;building[k].y1){  
        Cover(x1,y1,x2,building[k].y1,k+<span class="number">1</span>,c);  
        y1=building[k].y1;  
    }  
    <span class="keyword">if</span>(y2&gt;building[k].y2){  
        Cover(x1,building[k].y2,x2,y2,k+<span class="number">1</span>,c);  
        y2=building[k].y2;  
    }  
}  

<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{  
    ll i;  
    ll a,b,c;  
    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n)){  
        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++){  
            <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;a,&amp;b,&amp;c);  
            building[i].x1=a;  
            building[i].y1=<span class="number">0</span>;  
            building[i].x2=b;  
            building[i].y2=c;  
            building[i].sum=<span class="number">0</span>;  
        }  
        sort(building,building+n);  
        <span class="keyword">for</span>(i=n-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--)  
            Cover(building[i].x1,building[i].y1,building[i].x2,building[i].y2,i+<span class="number">1</span>,i);  
        ll ans=<span class="number">0</span>;  
        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)  
            ans+=building[i].sum;  
        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);  
    }  
    <span class="keyword">return</span> <span class="number">0</span>;  
}  
</code></pre>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/ACM/">ACM</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/11/02/Intel-Xeon-Phi协处理器高性能编程指南-总结/" title="Intel Xeon Phi协处理器高性能编程指南" itemprop="url">Intel Xeon Phi协处理器高性能编程指南</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Donald Wu" target="_blank" itemprop="author">Donald Wu</a>
		
  <p class="article-time">
    <time datetime="2015-11-02T10:42:59.327Z" itemprop="datePublished"> 發表於 2015-11-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>对读过的章节稍微做一下总结</p>
<h2 id="第二章">第二章</h2><p>线程和亲缘性：线程并不是越多越好，但至少要保证每核2个线程，因为根据现在xeon phi的设计，一个周期两条指令，预取的时候，不能用当前线程来预取。性能会减半。<br>亲缘性最好是scatter，负载均衡。</p>
<font size="1px" color="grey">这两者都既可以在程序中设置，也可以在环境变量中设置</font>

<p>内存带宽：增加核的使用，以增加内存缓冲区，但是核上线程增加可能是会牺牲内存带宽的，可以增加内存页大小</p>
<h2 id="第三章">第三章</h2><h3 id="向量化">向量化</h3><p>向量化是MIC优化的主题。</p>
<p>-O2 -O3 中实现了自动向量化<br>而ivdep补充说明了哪些块可以向量化</p>
<p>要用OpenMP扩展到多核也必须满足可向量化才行</p>
<h3 id="对齐">对齐</h3><p>前端对齐:_mm_malloc和_mm_free。（如数组首地址）<br>补白：（如二维数组行首）（注意一级cache大小)</p>
<h3 id="流存储">流存储</h3><p>写入前不读取#pragma vector nontemporal</p>
<h3 id="2MB大内存页">2MB大内存页</h3><p>mmap()</p>
<h2 id="第四章">第四章</h2><h3 id="代码扩展">代码扩展</h3><p>#pragma omp for collapse(2) 循环合并</p>
<h3 id="向量化-1">向量化</h3><p>#pragma simd 比 #pragma ivdep更强制</p>
<h3 id="剥离">剥离</h3><p>一个循环拆分成两个，以消除分支判断</p>
<h3 id="切片">切片</h3><p>多重循环的时候，不宜某一维度过长。如3维，y过长，则不能利用数据局部性，因为处理完一个x-y平面之后，才会z++，进入到下一个x-y平面，此时最前面的数据可能已经不在L2Cache中了。优化的方法是切片，并且把个切片y轴上的长度设为参数，调优。</p>
<h2 id="第五章">第五章</h2><h3 id="向量化的五种方法">向量化的五种方法</h3><ul>
<li>Cilk Plus</li>
<li>Array Notations</li>
<li>Auto-vectorization</li>
<li>SIMD Directives</li>
<li>MKL</li>
</ul>
<h3 id="六步方法论">六步方法论</h3><ul>
<li>测试基准版性能</li>
<li>用Intel Vtune Amplifier XE确定热点</li>
<li>使用英特尔编译器vec-report确定可向量化循环</li>
<li>使用英特尔编译器GAP报告和工具资源获得建议<font color="red">这是什么？还没用过</font></li>
<li>GAP实线意见及其他建议（如使用基本函数和/或数组符号）</li>
<li>重复</li>
</ul>
<h3 id="Cache流标题和下面的内容的关系是什么？">Cache流<font color="red">标题和下面的内容的关系是什么？</font></h3><ul>
<li>数据布局</li>
<li>数据对齐</li>
<li>预取 <font color="red">还不太熟悉</font><ul>
<li>硬件到L2缓存的自动预取（见第八章）</li>
<li>编译器到L1缓存的自动软件预取指令</li>
<li>编译器生成的预取（可从程序员提供的信息中获取帮助）</li>
<li>程序员通过L2和L1的预取能力进行的手动预取</li>
</ul>
</li>
<li>流存储 <ul>
<li>条件。可向量化，非时间局部性。<font color="red">还不太理解，书的翻译也不好</font></li>
<li>编译器生成clevicts。它告知硬件不预取将被彻底删除的数据，判断发生在编译时。分别讨论了处理器和协处理器上。</li>
</ul>
</li>
</ul>
<h3 id="编译器技巧一些杂技巧">编译器技巧<font color="red">一些杂技巧</font></h3><ul>
<li>避免手动展开。使用#pragma unroll。以直接了当的方式书写</li>
<li>编译器向量化的要求。几点容易理解的，和一些特殊情况。<ul>
<li>更杂的建议。可作为优化后复审的参考，这是一个总结，前面都提到过</li>
</ul>
</li>
<li>内联<br>  最内层的循环函数被自动内联很重要，用-opt-report-phase-ipo_inl观察是否内联，因为有的行为会关闭自动内联（如-pg 的性能分析功能）</li>
</ul>
<h3 id="编译器选项（同样是一些技巧）没看太懂，书写得有点混乱">编译器选项（同样是一些技巧）<font color="red">没看太懂，书写得有点混乱</font></h3><font color="red">这有一段不知所云，而且此处还没有涉及到预取</font><br>- 解决不明确，可能存在的隐含的混叠<font color="red">实际上这也是数据相关性的一种表现</font><br>    - 用restricted关键字说明指针具有独立性（即不混叠）<br>    - #pragma ivdep，允许编译器消除一些假定的相关性（而SIMD是强制性的）<br>    - 换用数组表示法或元素函数<br><br><br>###编译器指导指令，这部分内容很多<br>- SIMD<br>    - 使用的要求（底线，比ivdep的要求低），有一点比较奇怪但是也容易理解，就是循环体不能过大。另外一个奇怪的地方是，不要和快速浮点模式一起用<br><br><br><br>无主题（通用）<br>—-<br>source inte/composer**/bin/comiplervars.sh ia32/intel64 自动建立环境<br>#pragma omp master常用在输出调试信息上，只使用一个节点输出<br>private(xxx) 表示mic里和host上是独立的，不共享<br>各种优化后都要尝试不同线程数<br>在修改的时候要注意可扩展性和移植性<br><br><font color="red">明天继续补充</font>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/HPC/">HPC</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/06/29/Aria2源代码笔记——2/" title="Aria2源代码笔记——2.md" itemprop="url">Aria2源代码笔记——2.md</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Donald Wu" target="_blank" itemprop="author">Donald Wu</a>
		
  <p class="article-time">
    <time datetime="2015-06-29T09:14:02.000Z" itemprop="datePublished"> 發表於 2015-06-29</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>从0.2.0看到了0.2.1的所有commits，到后面就比较略了，因为框架形成后，无聊的细节就开始变得很多。学习了程序开发的迭代过程，之后就每次看一个release吧，这样也可以避免陷入无聊的细节中，节约时间。</p>
<h1 id="commit_1">commit 1</h1><ol>
<li>独立出Socket的实现模块SocketCore</li>
<li>将原来的实现封装进getSockfd()，establishConnection()，setNonBlockingMode()，closeConnection()，isWritable()，isReadable()，writeData()，readData()，peekData()。</li>
<li>取消了dup的使用，变成了内部的计数器，因为不需要两个不同的fd，不需要别名，使用计数器更快。</li>
</ol>
<h1 id="commit_2">commit 2</h1><ol>
<li>添加SSL的支持。（需要过两天单独学习SSL的架构？？？)<ol>
<li>configure文件系列</li>
<li>HttpConnection.cc里getHost()支持443端口了。</li>
<li>HttpRequestCommand.cc里executeInternal()，在建立httpConnection之前，判断如果req的协议是https（首先要系统支持，根据预定义宏判断），则initiateSecureConnection()        <strong>Http又忘了，需要复习一下书？？？</strong>    HttpInitiateConnectionCommand.cc里createInitiateConnectionCommand()；Request.cc里Request()。类似。</li>
<li>Socket.cc，SocketCore.cc提供支持。SocketCore.cc</li>
<li><strong>SocketCore.cc这是重点</strong>，writeData()和readData()单纯地把添加了SSL_write和SSL_read和SSL_peek，和send和recv和peek并排。<strong>closeConnection()的顺序是SSL_shutdown，然后是socket的close，然后是SSL_free，然后是SSL_CTX_free。当然这都是建立在SocketCore中secure开关打开的情况下</strong>。    initiateSecureConnection是新的函数，secure开关表示是否已经配置好ssl，一堆OpenSSL的api和定义的异常。需要学习？？？</li>
<li>main.cc中也有OpenSSL的初始化的api。SSL_load_error_strings();和SSL_library_init();</li>
</ol>
</li>
<li>common.h里是一些常用头文件</li>
<li>ChunkedEncoding的缓冲区变大。减少了addBuffer里冗余的strlen函数。</li>
<li>HttpResponseCommand里createHttpResponseCommand()，把transferEncoding写入了引擎的map映射表里（之前真的是没有用呢）</li>
<li>修正有/无ChunkEncoding时，真实下载的字节数不同bug。</li>
</ol>
<h1 id="commit_3">commit 3</h1><ol>
<li>检测ssl宏的使用逻辑错误。即使不支持ssl也要检测https，也该预留接口。<strong>只有在真正调用了api的时候，才是判断是否支持ssl的正确场合</strong></li>
</ol>
<h1 id="commit_4">commit 4</h1><ol>
<li>支持Referer。首先添加currentUrl和previousUrl，两者在resetUrl和redirectUrl时更新，第一次的referer由req自己指定。以后都是previousUrl，因为url会在Request之间通过Referer传递。main函数里，addCommand增加referer参数，和识别referer选项。</li>
</ol>
<h1 id="commit_5">commit 5</h1><p>略</p>
<ol>
<li>AbstractCommand的execute()的错误输出加上cuid，方便调试。</li>
<li>AbstractCommand的execute()收到重试异常时，不resetUrl，这样可以保留Referer。并且不立马向工厂请求createInitiateConnectionCommand。而是先加入SleepCommand，延迟后再去请求。睡眠的时间从引擎的option里查（如果是0就不加入SleepCommand了）。这个做法之前已在DownloadCommand中有，现将它上升到AbstractCommand，DownloadCommand只调用基类方法。</li>
<li>可变参数直接列表直接写va_list，不用…的记法，更方便，不需要在函数体内，再写va_list，va_start，va_end。</li>
<li>把SleepCommand的wait变成成员变量。并且加入程序选项。</li>
<li>main里proxy_port之前没有转成数字</li>
</ol>
<h1 id="commit_6">commit 6</h1><ol>
<li>有的服务器不支持相对路径，所以在HttpConnection在createRequest时，用parse了url得出来的结果来生成绝对路径。？？？</li>
</ol>
<h1 id="commit_7">commit 7</h1><ol>
<li>只有previousUrl不为空时才加入Referer</li>
</ol>
<h1 id="commit_8">commit 8</h1><ol>
<li>又是一堆看不懂的configure。还要学习make和configure？？？</li>
</ol>
<h1 id="commit_9">commit 9</h1><ol>
<li>string的字符的位置p规范成string::size_type，而不是unsigned int。因为会有和string::npos的比较。</li>
</ol>
<h1 id="commit_10">commit 10</h1><ol>
<li>AbstractCommand太短的TIMEOUT_SEC</li>
<li>把AbstractCommand的addSocketForXXXCheck和deletSocketForXXXCheck，统一用setXXXdCheckSocket封装。并且把管理sockets的任务从DownloadEngine下放到AbstractCommand，原因我还没想明白？？？。而且之前其实是半双工的，Write之前要删掉Read的socket。</li>
<li>DownloadComman的onAbort中(本commit中从onError改成onAbort)，从段管理器中卸载该段Id。</li>
<li>DownloadEngine.cc的更改？？？</li>
<li>HttpConnection.cc中createRequest，如果协议是ftp，则GET的url直接使用相对路径？？？</li>
<li>HttpConnection.cc的receiveResponse中header的实现改成string，没有必要使用自己定义的缓冲区扩充方案。</li>
<li>把可以改成const函数的改成const函数</li>
<li>httpConnection的req是固定的，因此在构造函数初始化，并且写成const</li>
<li>不再使用map作为headers，独立成HttpHeader类。</li>
<li>预留ftp接口</li>
<li>用const_iterator替代iterator</li>
<li>在Socket中封装beginListen，getAddrInfo，acceptConnection，establishConnection</li>
<li>一些ssl的bug修正</li>
</ol>
<h1 id="commit_11">commit 11</h1><ol>
<li>实现ftp。有了前面Http的经验，能看出作者开发ftp的时候顺利得多。FtpInitiateConnectionCommand发现里面还是http。不太懂，去学习一下ftp协议？？？</li>
</ol>
<h1 id="commit_12">commit 12</h1><ol>
<li>把常数都变成option</li>
</ol>
<h1 id="commit_13">commit 13</h1><ol>
<li>Ftp实现的一些非法情况的检查？？？</li>
</ol>
<h1 id="commit_14">commit 14</h1><ol>
<li>计算速度</li>
<li>预留SegmentSplitter新类</li>
</ol>
<h1 id="commit_15">commit 15</h1><ol>
<li>把原先的实现移动到SegmentSplitter新类中</li>
</ol>
<h1 id="记">记</h1><p>用git来研究一个项目成长过程太爽了！<br>作者在调试的时候用的cppunit，看起来很厉害的样子！可以学一下单元测试？？？<br>养成写// TODO的习惯</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/programming/">programming</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/4/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="顯示側邊欄"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隱藏側邊欄"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分類</p>
		<ul>
		
		  
			<li><a href="/categories/ACM/" title="ACM">ACM<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/AI/" title="AI">AI<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/CTF/" title="CTF">CTF<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Cryptography/" title="Cryptography">Cryptography<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/HPC/" title="HPC">HPC<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/Just4Fun/" title="Just4Fun">Just4Fun<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Math/" title="Math">Math<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Networking/" title="Networking">Networking<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Programming/" title="Programming">Programming<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Security/" title="Security">Security<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Server/" title="Server">Server<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/programming/" title="programming">programming<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/pwn/" title="pwn">pwn<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  

  <div class="linkslist">
  <p class="asidetitle">友情鏈接</p>
    <ul>
        
          <li>
            
            	<a href="http://blog.ikow.cn" target="_blank" title="k神">k神</a>
            
          </li>
        
          <li>
            
            	<a href="http://nlfox.sinaapp.com" target="_blank" title="狐神">狐神</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 訂閱</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> wuyihao. ^_^ <br/>
			Major in Network Engineering. Fancy 4 Algorithm, Infomation Security. Computer Network. etc</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="Donald Wu">Donald Wu</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回頂部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
